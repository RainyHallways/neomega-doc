import{_ as s,c as a,o as n,Q as p}from"./chunks/framework.c009d427.js";const C=JSON.parse('{"title":"数据包","description":"数据包监听相关示例","frontmatter":{"lang":"zh-CN","title":"数据包","description":"数据包监听相关示例"},"headers":[],"relativePath":"coromega_examples/数据包监听相关API/index.md","filePath":"coromega_examples/数据包监听相关API/index.md","lastUpdated":1724487756000}'),o={name:"coromega_examples/数据包监听相关API/index.md"},l=p(`<h1 id="数据包监听相关-api" tabindex="-1">数据包监听相关 API <a class="header-anchor" href="#数据包监听相关-api" aria-label="Permalink to &quot;数据包监听相关 API&quot;">​</a></h1><h2 id="监听数据包" tabindex="-1">监听数据包 <a class="header-anchor" href="#监听数据包" aria-label="Permalink to &quot;监听数据包&quot;">​</a></h2><ul><li>when_receive_packet_of_types(...) <ul><li><p>范围: 协程外</p></li><li><p>说明: 当机器人收到指定的数据包类型时, 启动一个新的协程并运行指定处理函数</p></li><li><p>参数:</p><ul><li>待接收的数据包类型列表, 这里有两种方式</li><li>1:when_receive_packet_of_types(数据包类型1, 数据包类型2, 数据包类型3 ...) e.g. :when_receive_packet_of_types(packets.Text, packets.CommandOutput) 这代表接收所罗列的数据包类型</li></ul><p>2:when_receive_packet_of_types(packets.all, no数据包类型1, no数据包类型2, no数据包类型3 ...) e.g. :when_receive_packet_of_types(packets.all, packets.noMovePlayer) 这代表接收除了 noXX 对应的 XX 类型数据包外的其余数据包类型 (反选)</p></li><li><p>返回: 监听器，监听器的处理函数的参数为数据包, 数据包具有以下三个成员函数</p><ul><li>name() 数据包名, 例如 &quot;IDText&quot;</li><li>id() 数据包类型编号, 例如 27</li><li>user_data() 数据包数据, user_data 形式, 注意, 您可以访问 user_data 形式数据包内部的成员 但是, user_data 并非普通的 lua 数据结构，因此您无法使用 pair 或 ipair 遍历数据包内部结构 您可以使用 ud2lua 函数将 user_data 转换为普通的 lua 数据结构以使用 pair 或 ipair, 但是, ud2lua 会造成额外的性能开销，因此您应该尽量避免使用 ud2lua 函数以提高插件性能</li></ul></li></ul><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">local</span><span style="color:#E1E4E8;"> packets </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> omega.</span><span style="color:#B392F0;">packets</span></span>
<span class="line"><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">when_receive_packet_of_types</span><span style="color:#E1E4E8;">(packets.</span><span style="color:#B392F0;">Text</span><span style="color:#E1E4E8;">, packets.</span><span style="color:#B392F0;">CommandOutput</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">start_new</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">(packet)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;packet name: %s id: %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">name</span><span style="color:#E1E4E8;">(), </span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">name</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> packets.</span><span style="color:#B392F0;">CommandOutput</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;detail packet %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">json_str</span><span style="color:#E1E4E8;">(packet)))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">local</span><span style="color:#E1E4E8;"> packet_userdata </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">user_data</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;detail packet (user_data) %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(packet_userdata))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;detail packet (lua table) %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">ud2lua</span><span style="color:#E1E4E8;">(packet_userdata)))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;Origin: %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(packet_userdata.</span><span style="color:#B392F0;">CommandOrigin</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Origin</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;OutputMessages[0].Message: %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(packet_userdata.</span><span style="color:#B392F0;">OutputMessages</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].</span><span style="color:#B392F0;">Message</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">end</span></span>
<span class="line"><span style="color:#F97583;">end</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">when_receive_packet_of_types</span><span style="color:#E1E4E8;">(packets.</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;">, packets.</span><span style="color:#B392F0;">noMovePlayer</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">local</span><span style="color:#24292E;"> packets </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> omega.</span><span style="color:#6F42C1;">packets</span></span>
<span class="line"><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">when_receive_packet_of_types</span><span style="color:#24292E;">(packets.</span><span style="color:#6F42C1;">Text</span><span style="color:#24292E;">, packets.</span><span style="color:#6F42C1;">CommandOutput</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">start_new</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(packet)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;packet name: %s id: %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">name</span><span style="color:#24292E;">(), </span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">name</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> packets.</span><span style="color:#6F42C1;">CommandOutput</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;detail packet %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">json_str</span><span style="color:#24292E;">(packet)))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">local</span><span style="color:#24292E;"> packet_userdata </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">user_data</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;detail packet (user_data) %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(packet_userdata))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;detail packet (lua table) %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">ud2lua</span><span style="color:#24292E;">(packet_userdata)))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;Origin: %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(packet_userdata.</span><span style="color:#6F42C1;">CommandOrigin</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Origin</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;OutputMessages[0].Message: %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(packet_userdata.</span><span style="color:#6F42C1;">OutputMessages</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].</span><span style="color:#6F42C1;">Message</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#D73A49;">end</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">when_receive_packet_of_types</span><span style="color:#24292E;">(packets.</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;">, packets.</span><span style="color:#6F42C1;">noMovePlayer</span><span style="color:#24292E;">)</span></span></code></pre></div></li></ul><h2 id="综合使用" tabindex="-1">综合使用 <a class="header-anchor" href="#综合使用" aria-label="Permalink to &quot;综合使用&quot;">​</a></h2><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">local</span><span style="color:#E1E4E8;"> omega </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;omega&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#79B8FF;">package.path</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">&quot;%s;%s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">package.path</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    omega.</span><span style="color:#B392F0;">storage_path</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">get_code_path</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;LuaLoader&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;?.lua&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">local</span><span style="color:#E1E4E8;"> coromega </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;coromega&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#79B8FF;">from</span><span style="color:#E1E4E8;">(omega)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">local</span><span style="color:#E1E4E8;"> packets </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> omega.</span><span style="color:#B392F0;">packets</span></span>
<span class="line"><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">when_receive_packet_of_types</span><span style="color:#E1E4E8;">(packets.</span><span style="color:#B392F0;">Text</span><span style="color:#E1E4E8;">, packets.</span><span style="color:#B392F0;">CommandOutput</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">start_new</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">(packet)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;packet name: %s id: %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">name</span><span style="color:#E1E4E8;">(), </span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">name</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> packets.</span><span style="color:#B392F0;">CommandOutput</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;detail packet %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">json_str</span><span style="color:#E1E4E8;">(packet)))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">local</span><span style="color:#E1E4E8;"> packet_userdata </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">packet</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">user_data</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;detail packet (user_data) %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(packet_userdata))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;detail packet (lua table) %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">ud2lua</span><span style="color:#E1E4E8;">(packet_userdata)))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;Origin: %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(packet_userdata.</span><span style="color:#B392F0;">CommandOrigin</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Origin</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">log</span><span style="color:#E1E4E8;">((</span><span style="color:#9ECBFF;">&quot;OutputMessages[0].Message: %s&quot;</span><span style="color:#E1E4E8;">):</span><span style="color:#79B8FF;">format</span><span style="color:#E1E4E8;">(packet_userdata.</span><span style="color:#B392F0;">OutputMessages</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].</span><span style="color:#B392F0;">Message</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">end</span></span>
<span class="line"><span style="color:#F97583;">end</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">coromega</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">run</span><span style="color:#E1E4E8;">()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">local</span><span style="color:#24292E;"> omega </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;omega&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#005CC5;">package.path</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">&quot;%s;%s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">package.path</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    omega.</span><span style="color:#6F42C1;">storage_path</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">get_code_path</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;LuaLoader&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;?.lua&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">local</span><span style="color:#24292E;"> coromega </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;coromega&quot;</span><span style="color:#24292E;">).</span><span style="color:#005CC5;">from</span><span style="color:#24292E;">(omega)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">local</span><span style="color:#24292E;"> packets </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> omega.</span><span style="color:#6F42C1;">packets</span></span>
<span class="line"><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">when_receive_packet_of_types</span><span style="color:#24292E;">(packets.</span><span style="color:#6F42C1;">Text</span><span style="color:#24292E;">, packets.</span><span style="color:#6F42C1;">CommandOutput</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">start_new</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(packet)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;packet name: %s id: %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">name</span><span style="color:#24292E;">(), </span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">name</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> packets.</span><span style="color:#6F42C1;">CommandOutput</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;detail packet %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">json_str</span><span style="color:#24292E;">(packet)))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">local</span><span style="color:#24292E;"> packet_userdata </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">packet</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">user_data</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;detail packet (user_data) %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(packet_userdata))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;detail packet (lua table) %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">ud2lua</span><span style="color:#24292E;">(packet_userdata)))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;Origin: %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(packet_userdata.</span><span style="color:#6F42C1;">CommandOrigin</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Origin</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">log</span><span style="color:#24292E;">((</span><span style="color:#032F62;">&quot;OutputMessages[0].Message: %s&quot;</span><span style="color:#24292E;">):</span><span style="color:#005CC5;">format</span><span style="color:#24292E;">(packet_userdata.</span><span style="color:#6F42C1;">OutputMessages</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].</span><span style="color:#6F42C1;">Message</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#D73A49;">end</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">coromega</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">run</span><span style="color:#24292E;">()</span></span></code></pre></div>`,5),e=[l];function t(c,r,E,y,F,i){return n(),a("div",null,e)}const d=s(o,[["render",t]]);export{C as __pageData,d as default};
